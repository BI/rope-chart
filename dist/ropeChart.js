!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("d3")):"function"==typeof define&&define.amd?define(["d3"],e):"object"==typeof exports?exports.RopeChart=e(require("d3")):t.RopeChart=e(t.d3)}(this,function(t){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var r=n(3);n(6)(r);n(7),n(8);var o=function(t){var e,n,o,a,i,l,u,s,c,f,p={},d=250,h=250,v=50,m=20,x=m,g=10,y=!1,b=5,w=!1,A="Average",T=[0,0],C=!0,N="&#8505;",M="d3-tip-mouse",R="top-rope",j="bottom-rope",O="top-knot",k="bottom-knot",L="focus-knot",z="threshold-knot",S=function(t){return Number(t.value)},B=function(t){return t.name},U=function(t){return r.round(r.mean(t,p.valueAccessor()))},E=function(t){var e="<label>Name: </label>"+t.label;return e+="<br/><label>Value: "+t.value};return p.render=function(a){e=r.select(t).html("").classed("Rope-Chart",!0).append("svg");var i=r.select(t).attr("id")+"-tip",u=r.tip().attr("class",M).attr("id",i).html(E).offset(T).positionAnchor("mouse");arguments.length&&p.data(a),e.attr("width",function(){return d}),e.attr("height",function(){return h});var s=o-g/2,c={x:s,y:n(l),height:h-n(l)-m,width:g,className:y?R:j},v={x:s,y:m,height:n(l)-m,width:g,className:y?j:R},x=[c,v],w=e.selectAll("rect").data(x).attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("height",function(t){return t.height}).attr("width",function(t){return t.width}).attr("class",function(t){return t.className});w.enter().append("rect").attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("height",function(t){return t.height}).attr("width",function(t){return t.width}).attr("class",function(t){return t.className}),w.exit().remove();var A=e.selectAll("circle").data(f).attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}).attr("r",function(t){return t.r}).attr("class",function(t){return t.className});A.enter().append("circle").attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}).attr("r",function(t){return t.r}).attr("class",function(t){return t.className}),A.exit().remove();var C=e.selectAll("text.value").data(f).attr("text-anchor",function(t){return"end"}).attr("x",function(t){return t.x-(t.r+b)}).attr("y",function(t){return t.y+t.adjustTextOverlap}).attr("dy",function(t){return".3em"}).attr("font-size",function(t){return 2*t.r+"px"}).text(function(t){return t.value});C.enter().append("text").attr("class",function(t){return"value"}).attr("text-anchor",function(t){return"end"}).attr("x",function(t){return t.x-(t.r+b)}).attr("y",function(t){return t.y+t.adjustTextOverlap}).attr("dy",function(t){return".3em"}).attr("font-size",function(t){return 2*t.r+"px"}).text(function(t){return t.value}),C.exit().remove();var O=e.selectAll("text.label").data(f).attr("text-anchor",function(t){return"start"}).attr("x",function(t){return t.x+(t.r+b)}).attr("y",function(t){return t.y+t.adjustTextOverlap}).attr("dy",function(t){return".3em"}).attr("font-size",function(t){return 2*t.r+"px"}).text(function(t){return t.label});O.enter().append("text").attr("class",function(t){return"label"}).attr("text-anchor",function(t){return"start"}).attr("x",function(t){return t.x+(t.r+b)}).attr("y",function(t){return t.y+t.adjustTextOverlap}).attr("dy",function(t){return".3em"}).attr("font-size",function(t){return 2*t.r+"px"}).text(function(t){return t.label}).filter(function(t){return void 0!==t.tooltipLabel}).append("tspan").classed("tooltip-label",!0).style("cursor","default").html(function(t){return" "+N}),O.exit().remove(),r.select("#"+u.attr("id")).empty()||r.select("#"+u.attr("id")).remove();var k=e.selectAll("tspan.tooltip-label");return k.call(u),k.on("mouseover",u.show).on("mouseout",u.hide).on("mousemove",u.updatePosition),p},p.data=function(t){return arguments.length?(c=t,a=c.filter(function(t){return p.valueAccessor()(t)===r.max(c,p.valueAccessor())})[0],i=c.filter(function(t){return p.valueAccessor()(t)===r.min(c,p.valueAccessor())})[0],l=U(c),multipleMaxes=p.getMultipleMaxes(),multipleMins=p.getMultipleMins(),n=r.scale.linear().domain([i.value,a.value]).range([h-x,x]),o=p.getRopeX(),f=p.generateNodes(),p):c},p.getMultipleMaxes=function(){var t=c.filter(function(t){return p.valueAccessor()(t)===p.valueAccessor()(a)});return 1!==t.length&&t},p.getMultipleMins=function(){var t=c.filter(function(t){return p.valueAccessor()(t)===p.valueAccessor()(i)});return 1!==t.length&&t},p.yScale=function(t){return arguments.length?(n=t,p):n},p.focusName=function(t){return arguments.length?(u=t,p):u},p.width=function(t){return arguments.length?(d=t,p):d},p.height=function(t){return arguments.length?(h=t,p):h},p.getRopeX=function(){return d*(v/100)},p.marginLeftPercentage=function(t){return arguments.length?(v=t,p):v},p.knotRadius=function(t){return arguments.length?(m=t,x=m,p):m},p.ropeWidth=function(t){return arguments.length?(g=t,p):g},p.chartGutter=function(t){return arguments.length?(x=t,p):x},p.flipDirection=function(t){return arguments.length?(y=t,p):y},p.showThreshold=function(t){return arguments.length?(w=t,p):w},p.thresholdLabel=function(t){return arguments.length?(A=t,p):A},p.thresholdGenerator=function(t){return arguments.length?(U=t,p):U},p.labelMargin=function(t){return arguments.length?(b=t,p):b},p.valueAccessor=function(t){return arguments.length?(S=t,p):S},p.nameAccessor=function(t){return arguments.length?(B=t,p):B},p.tooltipContent=function(t){return arguments.length?(E=t,p):E},p.showTooltip=function(t){return arguments.length?(C=t,p):C},p.tooltipLabel=function(t){return arguments.length?(N=t,p):N},p.generateNodes=function(){var t,e,r=p.generateNode(a,O),u=p.generateNode(i,k);s=c.filter(function(t){return p.nameAccessor()(t)===p.focusName()})[0];var f=p.generateNode(s,L);if(p.showThreshold()){var d="";C&&(d=N);var h={x:o,y:n(l),adjustTextOverlap:0,r:m,className:z,value:l,name:A,label:A,tooltipLabel:d};t=[r,u,h,f],e=p.adjustForOverlapAndMultiples(r,u,f,h)}else t=[r,u,f],e=p.adjustForOverlapAndMultiples(r,u,f);return e},p.generateNode=function(t,e){return{x:o,y:n(p.valueAccessor()(t)),r:m,adjustTextOverlap:0,className:e,value:p.valueAccessor()(t),name:p.nameAccessor()(t),label:p.nameAccessor()(t)}},p.adjustForOverlapAndMultiples=function(t,e,n,r){var o=p.nodeIsOverlapping(n,t),a=p.nodeIsOverlapping(n,e);if(o!==!1)n.adjustTextOverlap=o;else if(a!==!1)n.adjustTextOverlap=a;else if(r){var i=p.nodeIsOverlapping(n,r);r.value===n.value?(r.adjustTextOverlap=i/2,n.adjustTextOverlap=-i/2):(r.adjustTextOverlap=-(i/2),n.adjustTextOverlap=i/2)}multipleMaxes?n.value===t.value?(t.className="max-focus-knot",t.label=n.label+" and others",n=void 0):(t.label="Multiple: ",multipleMaxes.forEach(function(e){return t.label+=p.nameAccessor()(e)+", "}),t.label=t.label.substring(0,t.label.length-2)):n.value===t.value&&(n=void 0,t.className="max-focus-knot"),multipleMins?n&&n.value===e.value?(e.className="min-focus-knot",e.label=n.label+" and others",n=void 0):(e.label="Multiple: ",multipleMins.forEach(function(t){return e.label+=p.nameAccessor()(t)+", "}),e.label=e.label.substring(0,e.label.length-2)):n&&n.value===e.value&&(n=void 0,e.className="min-focus-knot");var l=[t,e];return r&&l.push(r),n&&l.push(n),l},p.nodeIsOverlapping=function(t,e){if(t.y<=e.y+2*m&&t.y>=e.y-2*m){var n=e.y-t.y;return n<0?2*m-Math.abs(n):n>0?-(2*m-n):2*m}return!1},p};t.exports=o},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},o=0;o<this.length;o++){var a=this[o][0];"number"==typeof a&&(r[a]=!0)}for(o=0;o<e.length;o++){var i=e[o];"number"==typeof i[0]&&r[i[0]]||(n&&!i[2]?i[2]=n:n&&(i[2]="("+i[2]+") and ("+n+")"),t.push(i))}},t}},function(t,e,n){function r(t,e){for(var n=0;n<t.length;n++){var r=t[n],o=d[r.id];if(o){o.refs++;for(var a=0;a<o.parts.length;a++)o.parts[a](r.parts[a]);for(;a<r.parts.length;a++)o.parts.push(s(r.parts[a],e))}else{for(var i=[],a=0;a<r.parts.length;a++)i.push(s(r.parts[a],e));d[r.id]={id:r.id,refs:1,parts:i}}}}function o(t){for(var e=[],n={},r=0;r<t.length;r++){var o=t[r],a=o[0],i=o[1],l=o[2],u=o[3],s={css:i,media:l,sourceMap:u};n[a]?n[a].parts.push(s):e.push(n[a]={id:a,parts:[s]})}return e}function a(t,e){var n=m(),r=y[y.length-1];if("top"===t.insertAt)r?r.nextSibling?n.insertBefore(e,r.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),y.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(e)}}function i(t){t.parentNode.removeChild(t);var e=y.indexOf(t);e>=0&&y.splice(e,1)}function l(t){var e=document.createElement("style");return e.type="text/css",a(t,e),e}function u(t){var e=document.createElement("link");return e.rel="stylesheet",a(t,e),e}function s(t,e){var n,r,o;if(e.singleton){var a=g++;n=x||(x=l(e)),r=c.bind(null,n,a,!1),o=c.bind(null,n,a,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=u(e),r=p.bind(null,n),o=function(){i(n),n.href&&URL.revokeObjectURL(n.href)}):(n=l(e),r=f.bind(null,n),o=function(){i(n)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else o()}}function c(t,e,n,r){var o=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=b(e,o);else{var a=document.createTextNode(o),i=t.childNodes;i[e]&&t.removeChild(i[e]),i.length?t.insertBefore(a,i[e]):t.appendChild(a)}}function f(t,e){var n=e.css,r=e.media;if(r&&t.setAttribute("media",r),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function p(t,e){var n=e.css,r=e.sourceMap;r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var o=new Blob([n],{type:"text/css"}),a=t.href;t.href=URL.createObjectURL(o),a&&URL.revokeObjectURL(a)}var d={},h=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},v=h(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),m=h(function(){return document.head||document.getElementsByTagName("head")[0]}),x=null,g=0,y=[];t.exports=function(t,e){e=e||{},"undefined"==typeof e.singleton&&(e.singleton=v()),"undefined"==typeof e.insertAt&&(e.insertAt="bottom");var n=o(t);return r(n,e),function(t){for(var a=[],i=0;i<n.length;i++){var l=n[i],u=d[l.id];u.refs--,a.push(u)}if(t){var s=o(t);r(s,e)}for(var i=0;i<a.length;i++){var u=a[i];if(0===u.refs){for(var c=0;c<u.parts.length;c++)u.parts[c]();delete d[u.id]}}}};var b=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},function(e,n){e.exports=t},function(t,e,n){e=t.exports=n(1)(),e.push([t.id,".Rope-Chart .bottom-knot,.Rope-Chart .top-knot{fill:#7dd0d4}.Rope-Chart .focus-knot,.Rope-Chart .max-focus-knot,.Rope-Chart .min-focus-knot{fill:#338ed8;stroke:#c55353;stroke-width:2px}.Rope-Chart .threshold-knot{fill:#105b98}.Rope-Chart .bottom-rope{fill:#b1b1b1}.Rope-Chart .top-rope{fill:#e4e4e4}.Rope-Chart tspan.tooltip-label{fill:#6482a5}.Rope-Chart tspan.tooltip-label:hover{fill:#30619a}",""])},function(t,e,n){e=t.exports=n(1)(),e.push([t.id,'.d3-tip-mouse{padding:8px;background:rgba(0,0,0,.8);border-radius:2px;pointer-events:none;z-index:100;outline:none}.d3-tip-mouse,.d3-tip-mouse label{font-size:13px;line-height:16px;color:#fff}.d3-tip-mouse label{font-family:Abel,Helvetica,Arial,sans-serif;font-weight:400;display:inline}.d3-tip{font-size:13px;line-height:16px;padding:8px;background:rgba(0,0,0,.8);color:#fff;border-radius:2px;pointer-events:none;z-index:100;outline:none}.d3-tip label{font-family:Abel,Helvetica,Arial,sans-serif;font-weight:400}.d3-tip:after{box-sizing:border-box;display:inline;font-size:10px;width:100%;line-height:1;color:rgba(0,0,0,.8);position:absolute;pointer-events:none;z-index:100}.d3-tip.n:after{text-align:center}.d3-tip.n:after,.d3-tip.ne:after{content:"\\25BC";top:auto;bottom:-7px;left:0}.d3-tip.ne:after{text-align:left;padding-left:8px}.d3-tip.nw:after{content:"\\25BC";top:auto;bottom:-7px;left:0;text-align:right;padding-right:8px}.d3-tip.e:after{content:"\\25C0";margin:-4px 0 0;top:50%;left:-7px}.d3-tip.s:after{content:"\\25B2";margin:0 0 1px;top:-8px;left:0;text-align:center}.d3-tip.w:after{content:"\\25B6";margin:-4px 0 0 -2px;top:50%;left:100%}',""])},function(t,e,n){var r,o,a;!function(i,l){o=[n(3)],r=l,a="function"==typeof r?r.apply(e,o):r,!(void 0!==a&&(t.exports=a))}(this,function(t){return t.tip=function(){function e(t){C=g(t),N=C.createSVGPoint(),document.body.appendChild(T)}function n(t){var e=window.outerWidth;return t>e&&t-e}function r(t){window.outerWidth;return t<0&&-t}function o(t){var e=document.documentElement.scrollTop||document.body.scrollTop,n=window.innerHeight+e;return t>n&&t-n}function a(){return"n"}function i(){return[0,0]}function l(){return" "}function u(){return"shape"}function s(){var t=y();return{top:t.n.y-T.offsetHeight,left:t.n.x-T.offsetWidth/2}}function c(){var t=y();return{top:t.s.y,left:t.s.x-T.offsetWidth/2}}function f(){var t=y();return{top:t.e.y-T.offsetHeight/2,left:t.e.x}}function p(){var t=y();return{top:t.w.y-T.offsetHeight/2,left:t.w.x-T.offsetWidth}}function d(){var t=y();return{top:t.nw.y-T.offsetHeight,left:t.nw.x-T.offsetWidth}}function h(){var t=y();return{top:t.ne.y-T.offsetHeight,left:t.ne.x}}function v(){var t=y();return{top:t.sw.y,left:t.sw.x-T.offsetWidth}}function m(){var t=y();return{top:t.se.y,left:t.e.x}}function x(){var e=t.select(document.createElement("div"));return e.style({position:"absolute",top:0,opacity:0,"pointer-events":"none","box-sizing":"border-box"}),e.node()}function g(t){return t=t.node(),"svg"===t.tagName.toLowerCase()?t:t.ownerSVGElement}function y(){for(var e=M||t.event.target;"undefined"==typeof e.getScreenCTM&&"undefined"===e.parentNode;)e=e.parentNode;var n={},r=e.getScreenCTM(),o=e.getBBox(),a=o.width,i=o.height,l=o.x,u=o.y;return N.x=l,N.y=u,n.nw=N.matrixTransform(r),N.x+=a,n.ne=N.matrixTransform(r),N.y+=i,n.se=N.matrixTransform(r),N.x-=a,n.sw=N.matrixTransform(r),N.y-=i/2,n.w=N.matrixTransform(r),N.x+=a,n.e=N.matrixTransform(r),N.x-=a/2,N.y-=i/2,n.n=N.matrixTransform(r),N.y+=i,n.s=N.matrixTransform(r),n}var b=a,w=i,A=l,T=x(),C=null,N=null,M=null,R=u;e.show=function(){var a=Array.prototype.slice.call(arguments);a[a.length-1]instanceof SVGElement&&(M=a.pop());var i,l=A.apply(this,a),u=w.apply(this,a),s=b.apply(this,a),c=t.select(T),f=O.length,p=document.documentElement.scrollTop||document.body.scrollTop,d=document.documentElement.scrollLeft||document.body.scrollLeft;for(c.html(l).style({opacity:1,"pointer-events":"all","z-index":100,display:"block"});f--;)c.classed(O[f],!1);i=j.get(s).apply(this);var h=i.left+u[1]+d+c.property("offsetWidth"),v=i.top+u[0]+p+c.property("offsetHeight"),m=n(h),x=o(v),g=i.left+u[1]+d,y=r(g),C=i.top+u[0]+p;return m&&(g-=m),y&&(g+=y),x&&(C-=x),"shape"===R()?c.classed(s,!0).style({top:C+"px",left:g+"px"}):"mouse"===R()&&(c.classed(s,!0),e.updatePosition(u)),e},e.hide=function(){var n=t.select(T);return n.style({opacity:0,"pointer-events":"none","z-index":-1,display:"none"}),e},e.updatePosition=function(a){var i=t.select(T),l=t.mouse(t.select("html").node())[0]+10,u=t.mouse(t.select("html").node())[1]+20,s=l+i.property("offsetWidth"),c=u+i.property("offsetHeight"),f=n(s),p=r(l),d=o(c);return a.length&&(l+=a[0],u+=a[1]),f&&(l-=f),p&&(l+=p),d&&(u-=d),i.style({top:u+"px",left:l+"px"}),e},e.attr=function(n,r){if(arguments.length<2&&"string"==typeof n)return t.select(T).attr(n);var o=Array.prototype.slice.call(arguments);return t.selection.prototype.attr.apply(t.select(T),o),e},e.style=function(n,r){if(arguments.length<2&&"string"==typeof n)return t.select(T).style(n);var o=Array.prototype.slice.call(arguments);return t.selection.prototype.style.apply(t.select(T),o),e},e.direction=function(n){return arguments.length?(b=null==n?n:t.functor(n),e):b},e.positionAnchor=function(n){return arguments.length?(R=null==n?n:t.functor(n),e):R},e.offset=function(n){return arguments.length?(w=null==n?n:t.functor(n),e):w},e.html=function(n){return arguments.length?(A=null==n?n:t.functor(n),e):A};var j=t.map({n:s,s:c,e:f,w:p,nw:d,ne:h,sw:v,se:m}),O=j.keys();return e},t.tip})},function(t,e,n){var r=n(4);"string"==typeof r&&(r=[[t.id,r,""]]);n(2)(r,{});r.locals&&(t.exports=r.locals)},function(t,e,n){var r=n(5);"string"==typeof r&&(r=[[t.id,r,""]]);n(2)(r,{});r.locals&&(t.exports=r.locals)}])});